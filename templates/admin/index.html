{% extends "base.html" %}

{% block content %}
<div class="max-w-7xl mx-auto">
    <div class="flex justify-between items-center mb-12">
        <h2 class="text-4xl font-bold text-gray-900 dark:text-white">Admin Dashboard</h2>
        <a href="{{ url_for('admin.logout') }}" class="bg-red-500 hover:bg-red-600 text-white px-4 py-2 rounded-lg transition-colors flex items-center gap-2">
            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"/>
            </svg>
            Logout
        </a>
    </div>

    <div class="grid md:grid-cols-3 gap-8">
        <!-- Sidebar -->
        <div class="md:col-span-1">
            <div class="bg-gray-50 dark:bg-gray-800/50 p-6 rounded-lg">
                <h3 class="text-2xl font-bold mb-4">Navigation</h3>
                <ul class="space-y-2">
                    <li><a href="#" class="block py-2 text-neon-accent font-semibold">Upload Image</a></li>
                </ul>
            </div>
        </div>

        <!-- Main Content -->
        <div class="md:col-span-2">
            {% with messages = get_flashed_messages(with_categories=true) %}
                {% if messages %}
                    <div class="mb-4">
                        {% for category, message in messages %}
                            <div class="p-4 rounded-md 
                                {% if category == 'success' %} bg-green-100 border-green-400 text-green-700 
                                {% elif category == 'error' %} bg-red-100 border-red-400 text-red-700
                                {% elif category == 'warning' %} bg-yellow-100 border-yellow-400 text-yellow-700
                                {% else %} bg-gray-100 border-gray-400 text-gray-700
                                {% endif %}">
                                {{ message }}
                            </div>
                        {% endfor %}
                    </div>
                {% endif %}
            {% endwith %}

            {% if image %}
                <div class="bg-gray-50 dark:bg-gray-800/50 p-8 rounded-lg mb-8">
                    <h3 class="text-3xl font-bold mb-6">Uploaded Image</h3>
                    <img src="{{ url_for('gallery.serve_image', unique_id=image.unique_id) }}" alt="{{ image.caption }}" class="max-w-full h-auto rounded-lg">
                </div>
            {% endif %}

            <div class="bg-gray-50 dark:bg-gray-800/50 p-8 rounded-lg">
                <h3 class="text-3xl font-bold mb-6">Upload New Image</h3>
                <form action="{{ url_for('admin.upload_image') }}" method="post" enctype="multipart/form-data" class="space-y-6">
                    <div>
                        <label for="image" class="block text-sm font-medium text-gray-700 dark:text-gray-300">Image File</label>
                        <input type="file" name="image" id="image" required class="mt-1 block w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-neon-accent/20 file:text-neon-accent hover:file:bg-neon-accent/30">
                    </div>
                    <div>
                        <label for="caption" class="block text-sm font-medium text-gray-700 dark:text-gray-300">Caption</label>
                        <input type="text" name="caption" id="caption" placeholder="e.g., A beautiful sunset" class="mt-1 block w-full rounded-md border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 shadow-sm focus:border-neon-accent focus:ring-neon-accent">
                    </div>
                    <div>
                        <label for="location" class="block text-sm font-medium text-gray-700 dark:text-gray-300">Location (lat, long)</label>
                        <input type="text" name="location" id="location" placeholder="e.g., 40.7128, -74.0060" class="mt-1 block w-full rounded-md border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 shadow-sm focus:border-neon-accent focus:ring-neon-accent">
                    </div>
                    <div>
                        <label for="tags" class="block text-sm font-medium text-gray-700 dark:text-gray-300">Tags (comma-separated)</label>
                        <input type="text" name="tags" id="tags" placeholder="e.g., city, skyline, night" class="mt-1 block w-full rounded-md border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 shadow-sm focus:border-neon-accent focus:ring-neon-accent">
                    </div>
                    <div>
                        <button type="submit" class="w-full text-center px-4 py-2 bg-neon-accent text-white rounded-lg hover:bg-opacity-80 transition-colors">Upload Image</button>
                    </div>
                </form>
            </div>

            <div class="bg-gray-50 dark:bg-gray-800/50 p-8 rounded-lg mt-8">
                <h3 class="text-3xl font-bold mb-6">Existing Images</h3>
                <div class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4">
                    {% if images %}
                        {% for img in images %}
                            <div class="relative group">
                                <img src="{{ url_for('gallery.serve_thumbnail', unique_id=img.unique_id) }}" alt="{{ img.caption }}" class="w-full h-48 object-cover rounded-lg" loading="lazy">
                                <div class="absolute inset-0 bg-black bg-opacity-50 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity">
                                    <div class="flex space-x-4">
                                        <a href="{{ url_for('admin.edit_image_page', unique_id=img.unique_id) }}" class="bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded-lg transition-colors">Edit</a>
                                        <form method="post" action="{{ url_for('admin.delete_image', unique_id=img.unique_id) }}" class="inline" onsubmit="return confirm('Are you sure you want to delete this image? This action cannot be undone.')">
                                            <button type="submit" class="bg-red-500 hover:bg-red-600 text-white px-4 py-2 rounded-lg transition-colors">Delete</button>
                                        </form>
                                    </div>
                                </div>
                            </div>
                        {% endfor %}
                    {% else %}
                        <p>No images found.</p>
                    {% endif %}
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %} 